쿠버네티스는 컨테이너화된 어플리케이션의 자동 배포, 스케일링 및 관리를 위한 컨테이너 오케스트레이션 플랫폼

### 주요 특징과 기능

- **컨테이너 오케스트레이션**: 수많은 컨테이너의 배포와 관리를 자동화
- **자동 확장**: 트래픽이나 리소스 사용량에 따라 자동으로 애플리케이션을 확장
- **자동 복구**: 장애가 발생한 컨테이너를 자동으로 다시 시작하거나 교체
- **서비스 디스커버리와 로드 밸런싱**: 내장된 DNS와 로드 밸런싱 기능을 제공
- **롤링 업데이트와 롤백**: 다운타임 없이 애플리케이션을 업데이트하고, 문제 발생 시 이전 버전으로 롤백
- **비밀 및 구성 관리**: 민감한 정보와 애플리케이션 설정을 안전하게 관리

### 쿠버네티스 오브젝트

쿠버네티스 시스템에서 지속성을 갖는 엔티티, 오브젝트는 클러스터의 상태를 나타낸다.  
실행중인 컨테이너, 애플리케이션이 사용할 수 있는 리소스, 애플리케이션 동작 방식에 대한 정책(재시작, 장애 허용 등)을 나타낸다.

**Pod**
- 쿠버네티스의 가장 기본적인 배포 단위, 하나 이상의 컨테이너 그룹으로 같은 노드에서 실행됨
- 공유 스토리지, 네트워크 리소스를 가짐
- 애플리케이션들이 포드 안에서 컨테이너로 실행  
**Deployment**
- pod와 ReplicaSet에 대한 선언적 업데이트 제공
- 롤링 업데이트, 롤백 제공  
**Service**
- Pod 집합에 대한 네트워크 접근 방식을 정의
- 내부/외부 트래픽을 Pod로 라우팅
- 유형: ClusterIP, NodePort, LoadBalancer, ExternalName  
**Volume**
- Pod 내 컨테이너 간 데이터 공유
- 컨테이너가 재시작되더라도 데이터 유지  
**Ingress**
- 클러스터 외부에서 내부 서비스로의 HTTP/HTTPS 라우팅 규칙
- 웹 애플리케이션 노출에 유용  
**ConfigMap & Secret**
- 설정 정보를 저장
- 환경 변수, 명령줄 인수, 설정 파일로 사용 가능
- Spring Boot 애플리케이션의 설정을 외부화할 때 유용  
**Namespace**
- 클러스터 내의 리소스 그룹을 분리
- 여러 팀이나 프로젝트가 하나의 클러스터를 공유할 때 유용  
**StatefulSet**
- 상태 유지가 필요한 애플리케이션을 위한 워크로드 API
- 데이터베이스 등의 애플리케이션에 적합  
**ReplicaSet**
- 지정된 수의 Pod 복제본이 실행되도록 보장
- 보통 Deployment에 의해 관리됨
- 상태 유지가 필요한 애플리케이션을 위한 워크로드 API
- 데이터베이스 등의 애플리케이션에 적합  
**HorizontalPodAutoscaler**
- Pod의 CPU 사용률 등 메트릭에 따라 자동으로 Pod 수 조절

## 쿠버네티스 아키텍처

쿠버네티스는 master-worker 모델 구조를 따른다.

컨트롤 플레인에 해당하는 master 노드가 worker 노드를 관리하고 worker 노드들은 실제로 컨테이너를 실행한다.  


### 컨트롤 플레인(master 노드) 구성

클러스터의 두뇌 역할을하며 클러스터 전체를 관리하고 제어하는 역할

**API 서버: 모든 쿠버네티스 작업의 진입점**

- 쿠버네티스 api를 호출하는 프론트 엔드
- 모든 내부/외부 통신의 게이트웨이 역할
- RESTful API 형태로 클러스터와의 상호작용 제공
- 모든 요청을 검증하고 처리, 인증/권한 부여/승인을 처리
- etcd에 저장된 클러스터 상태에 접근하고 업데이트

**etcd: 클러스터 데이터를 저장하는 분산 키-값 저장소**
- 쿠버네티스 리소스의 모든 상태정보 저장(포드, 서비스, 네트워크 정책 등)
- 트랜잭션 기반 작업과 워치 기능 제공
- TTL 기반 키 만료 지원

**스케줄러: 포드를 노드에 할당**
- 리소스 요구사항, 하드웨어/소프트웨어 제약 조건, 정책을 고려하여 포드를 노드에 할당

**컨트롤러 매니저: 리소스를 제어하는 컨트롤러 실행** 
- 클러스터 상태를 감시하고 현재 상태를 원하는 상태로 변경하는 여러 컨트롤러 실행
- Node 컨트롤러 : 노드 상태 모니터링 및 응답
- replication 컨트롤러 : 포드 복제본 수 유지
- Endpoint 컨트롤러 : 서비스와 포드 연결
- Service Account & Token : 네임스페이스에 대한 기본 계정과 API 엑세스 토큰 생성
- Deployment 컨트롤러 : 선언적 애플리케이션 업데이트 관리
- statefulSet 컨트롤러 : 상태 유지 애플리케이션 관리
- Job 컨트롤러 : 일회성 작업 실행 관리

**클라우드 컨트롤러 매니저(클라우드 환경)**
- 클라우드 제공자 API와 쿠버네티스 간의 상호작용 관리
- 클라우드별 기능과 쿠버네티스 코어 기능 분리
- Node 컨트롤러 : 클라우드 인스턴스에 대한 노드 정보 업데이트
- Route 컨트롤러 : 클라우드 환경에서 네트워크 라우팅 설정
- Service 컨트롤러 : 클라우드 로드 밸런서 생성, 업데이트, 삭제

### 컨트롤 플레인 구성요소간 상호작용

**API 요청 흐름**
- 클라이언트 > kube-apiserver > etcd(저장)
- 리소스 변경사항은 관련 컨트롤러/스케줄러에 알림

**컨트롤 루프 흐름**
- 컨트롤러는 kube-apiserver를 통해 상태 관찰
- 변경 필요 시 kube-apiserver를 통해 업데이트

**포드 배포 흐름**
- Deployment 생성 > Deployment 컨트롤러가 ReplicaSet 생성
- ReplicaSet 컨트롤러가 Pod 생성
- Scheduler가 노드 할당
- Kubelet(워커 노드)이 포드 실행

### 워커노드 구성
- **kubelet**: 각 노드에서 실행되는 에이전트로, 컨테이너가 파드에서 실행되도록 관리
- **kube-proxy**: 네트워크 규칙 유지 관리 및 연결 포워딩 담당
- **컨테이너 런타임**: 컨테이너를 실행하는 소프트웨어(Docker, containerd, CRI-O 등)