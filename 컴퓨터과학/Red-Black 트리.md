  

### Red-Black 트리

- 이진 탐색 트리(BST)의 한 종
- 스스로 균형 잡는 트리
- BST의 worst case의 단점을 개선
- 모든 노드는 red 혹은 black

  

**Red-Black 트리의 속성**

- 모든 노드는 red 혹은 blakc
- 루트 노드는 black
- nil노드가 존재한다.

- 존재하지 않음을 의미하는 노드

- 자녀가 없을 때 자녀를 nil 노드로 표기

- 값이 있는 노드와 동등하게 취급

- RB 트리에서 leaf 노드는 nil 노드

![[nil_노드.png]]

  

- #3. 모든 nil(leaf)노드는 black
- #4. red의 자녀들은 black >> red가 연속적으로 존재할 수 없다.
- #5. 임의의 노드에서 자손 nil 노드들까지 경로들의 black수는 같다(자기 자신은 카운트 제외)

  

노드 x의 black height

- 노드 x에서 임의의 자손 nil 노드까지 내려가는 경로에서의 black 수(자기 자신은 카운트 제외)
- #5 속성을 만족해야 성립하는 개념

  

![[redblacktree_속성.png]]

  

### 레드블랙트리는 어떻게 균형을 잡는가?

삽입 / 삭제 시 주로 #4, \#5를 위반하며 이들을 해결하려고 구조를 바꾸다 보면 자연스럽게 균형이 잡힌다.

  

### Red-Black 트리의 삽입 방식

1. 삽입 전 RB 트리 속성 만족한 상태
2. 삽입 방식은 일반적인 BST와 동일
3. 삽입 후 RB 트리 위반 여부 확인
4. RB 트리 속성을 위반했다면 재조정
5. RB 트리 속성을 다시 만족

  

**삽입 노드의 색 : 항상 red**

>> red로 삽입하는 이유는 #5 속성을 만족하기 위해

  

### #4 속성 위반 case3

한쪽으로 편향된 트리구조 >> 회전을 통한 속성위반 해결

![[redblacktree_회전.png]]

1. 20과 50의 색을 바꾼다.
2. 20 기준으로 오른쪽으로 회전한다.

  

삽입된 red노드가 부모의 왼쪽자녀 & 부무도 red고 할아버지의 왼쪽 자녀 & 삼촌(=부모의 형제)은

black이라면 부모와 할아버지의 색을 바꾼 후 할아버지 기준으로 오른쪽으로 회전한다.

  

### **#4 속성 위반 case2**

![[redblacktree_회전2.png]]

case3과 다른 점은 할아버지까지의 경로가 꺽였다는 점

>> 꺽인 부분을 펴줘서 case 3와 같은 형태로 만들면 해결 가능

1. 20기준으로 왼쪽으로 회전
2. 40과 50의 색을 바꾼다
3. 50기준으로 오른쪽으로 회전한다.

  

삽입된 red노드가 부모의 오른쪽 자녀 & 부모도 red고 할아버지의 왼쪽 자녀 & 삼촌은 black이라면 부모를 기준으로 왼쪽으로 회전한 뒤 case 3의 방식으로 해결

### #4 속성 위반 case1

![[redblacktree_회전3.png]]

1. \#4를 만족시키면서 \#5를 유지하려면 10과 50을 black으로 바꾸고 20을 red로 바꾼다.
2. 하지만 20이 루트 노드라서 #2 속성을 위반 >> 20을 black으로 바꿔준다.

  

![[redblacktree_속성2.png]]

case 1의 최종 모양

  

삽입된 red 노드의 부모도 red & 삼촌도 red라면 부모와 삼촌을 black으로 바꾸고 할아버지를 red로

바꾼 뒤 할아버지에서 다시 확인을 시작

  

### Red-Black Tree의 삭제

1. 삭제 전 RB트리 속성 만족한 상태
2. 삭제 방식은 일반적인 BST와 동일
3. 삭제 후 RB트리 속성 위반 여부 확인
4. RB 트리 속성을 위반했다면 재조정
5. RB 트리 속성을 다시 만족

  

예시 1(자녀노드가 없거나 하나일 때)

![[redblacktree_삭제1.png]]

  

예시 2(자녀노드가 2개일 때)

![[redblacktree_삭제2.png]]

successor는 해당 노드의 오른쪽 자녀노드 중 가장 작은 값

  

### 삭제되는 색이 Red라면 어떠한 속성도 위반되지 않는다.

  

### 삭제되는 색이 Black이라면 #2, #4, \#5를 위반할 수 있다..

  

삭제되는 색이 black이고 #5 위반 일 때 extra black 부여

![[redblacktree_extra_black.png]]

>> 노드에 추가적으로 블랙을 하나 더 붙여서 블랙이 한 개 더 카운트 되도록 함

  

black노드에 붙으면 doubly black

red노드에 붙으면 red and black

  

red and black 해결하기 : red and black을 black으로 바꾸면 해결

  

doubly black 해결하기

  

**출처 : 유튜브 쉬운코드 https://www.youtube.com/@ezcd