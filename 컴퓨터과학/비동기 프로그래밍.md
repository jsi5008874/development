  

### 동기 프로그래밍(synchronous programming) : 여러 작업(task)들을 순차적으로 실행하도록 개발

  

### 비동기 프로그래밍(**synchronous programming**) : 여러 작업들을 독립적으로 실행하도록 개발

  

간혹 비동기 프로그래밍과 멀티 스레딩을 같은걸로 생각하는 경우가 있는데 명확히 다르다.

비동기 프로그래밍은 여러 작업을 독립적으로 실행하는 **방법론**이고

멀티스레딩은 비동기 프로그래밍의 한 종류이다.

  

비동기 프로그래밍을 가능하게 하는것은

1. 멀티 스레딩

>> 여러 스레드가 동시에 독립적으로 실행

1. non-block I/O

>> 한 개의 스레드가 task1을 non-block으로 I/O작업에 보내놓고 task2를 CPU에서 실행

(I/O작업과 CPU 실행은 동시에 가능하기 때문에 독립적으로 여러 작업이 가능)

  

### I/O 관점에서의 비동기

1. synchronous I/O = block I/O, asynchronous I/O = non-block I/O

  

1. synchronous I/O : 요청자가 I/O완료까지 챙겨야 할 때

asynchronous I/O : 완료를 noti 주거나 callback으로 처리

  

1. asynchronous I/O : block I/O를 다른 스레드에서 실행

ex) t1을 실행 중 block I/O를 해야하는데 t1대신 t2를 생성해서 t2가 block I/O를 하게 만들고 t1은 계속 실행을 함, t2가 block I/O 끝나면 t1에 결과를 합쳐서 결국 t1은 계속 실행되도록 하는 것

  

### 백엔드 아키텍처 관점에서의 비동기

  

하나의 서비스는 기능과 역할에 따라 여러 개의 마이크로 서비스로 구성되고 이들 사이에는 빈번하게 커뮤니케이션이 발생

  

![[동기_커뮤니케이션.png]]

A, B, C라는 마이크로 서비스들이 존재

각각 서비스들은 서로 통신하는 API를 구축해놓았다고 가정

  

1. A가 실행 중 B가 관심가질만한 이벤트를 발견해서 API를 통해 B에게 전송
2. B는 이벤트를 받아 실행 중 C가 관심가질만한 이벤트를 API로 전송
3. C가 처리완료 후 B에게 ok 사인 전송, B는 ok 사인 받은후 멈췄던 실행을 재개
4. B 실행 종료 후 A에게 ok 사인 전송, A는 ok 사인 받은 후 멈췄던 실행 재개

  

이렇게 API 콜을 보낸 후 자신의 실행을 멈췄다가 ok사인을 받으면 다시 실행을 하는데

여기서 문제는 만약에 C에서 오류가 발생해서 계속 대기 한다면 B와 A까지 실행을 계속 멈추게되고

이는 서비스 장애로 이어지게 된다.

  

### 이를 위해 나온것이 asynchronous communication

  

![[비동기_커뮤니케이션.png]]

  

1. A 실행 중 이벤트가 생기면 메세지 큐에 이벤트를 넣고 A는 계속 실행
2. B는 메세지큐를 컨슘하기위해 지켜보다가 메세지큐에 이벤트가 들어오면 컨슘해서 실행
3. C도 마찬가지

  

이렇게 한 서비스가 장애가 생겨도 서로 영향을 주지 않게됨

  

메세지 큐를 이용한 방식은 안정성이 좋지만 API보다 반응성은 느리다.

즉각적으로 필요한 정보는 API를 구축해서 하는게 맞지만 그렇지 않다면 비동기방식으로 하면 더 안정적인 서버 아키텍처가 된다.


**출처 : 유튜브 쉬운코드 https://www.youtube.com/@ezcd