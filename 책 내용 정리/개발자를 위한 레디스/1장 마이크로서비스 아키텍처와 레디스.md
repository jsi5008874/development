

## NoSQL의 등장 배경
소프트웨어의 핵심은 데이터이고 올바른 데이터 저장소를 선택하고 운영하는 문제는 굉장히 중요한 부분이다.

지난 몇십 년 동안 모놀리틱 > 마이크로서비스 아키텍처로 변화하고 있으며 데이터 저장소 특징도 다양하게 발전해왔다.
따라서 소프트웨어 아키텍처의 변화로 인해 데이터 저장소에도 어떤 변화와 발전이 필요한지 알아야한다.
### 모놀리틱 아키텍처
모놀리틱 아키텍처는 전체 애플리케이션을 하나의 통합된 패키지로 개발, 배포하는 방식
모든 시스템이 하나로 연결돼 관리된다.
ex) 하나의 프로젝트에 고객관리, 상품관리, 결제 등 모든 서비스가 통합되어 있다.

작은 규모는 모놀리틱 구조가 운영하기 쉽지만 규모가 확장되면 많은 단점이 존재한다.

**모놀리틱의 장점**
1.  구조의 단순함
	프로젝트 구조가 직관적이고 단순하여 새 기능 추가도 간단하게 가능 
	한 번에 전체 코드 파악이 가능하다
2. 쉬운 배포와 운영
	하나에 통합되었기 때문에 배포 과정이 단순함
	로그 관리, 모니터링 등 운영 포인트가 하나로 운영 부담이 적음
3. 개발 생산성
	IDE에서 전체 코드 디버깅 가능
	메소드 호출로 간단한 내부 통신(MSA는 네트워크 호출 필요)
	기능 추가가 간편함

**모놀리틱의 단점**
1. 확장성의 한계
	하나의 파트에 리소스가 부족해도 전체를 확장해야함
2. 기술 스택 제약
	프레임워크나 언어의 변경이 전체에 영향을 미쳐서 새로운 기술 도입이 어려움
	(일부 기능만 Node.js 또는 Python으로 개발하고 싶어도 불가능 > 유연한 대처가 어렵다)
3. 빌드, 배포 시간 장기화
	하나의 모듈을 수정해도 전체를 다시 배포해야해서 서버의 빌드, 배포 시간이 길어짐

### 마이크로서비스 아키텍처
마이크로서비스는 독립된 각각의 모듈을 조립해 하나의 서비스를 만드는 아키텍처
기능별로 서비스를 나누어서 독립적으로 동작하는 서비스를 의미
업데이트, 테스트, 배포, 확장 모두 독립적으로 수행 가능하다.
ex) 고객관리, 상품관리, 결제 등 각각의 서비스가 독립적인 모듈로 존재

**마이크로서비스의 장점**
1. 독립적인 배포와 확장성
	특정 서비스의 서버만 쉽게 확장이 가능
	모두 독립적이기 때문에 업데이트 된 모듈만 배포 가능
2. 기술 스택의 자유도
	서비스 별 최적화된 기술 선택 가능
	새로운 기술 도입이 쉬움
3. 장애 격리
	장애가 발생해도 독립적인 모듈이기 때문에 다른 서비스로 장애가 전파되지 않음

**마이크로서비스의 단점**
1. 복잡한 네트워크 통신
	모든 서비스가 네트워크로 연결되어 있어 네트워크 오류 가능성 증가
	복잡한 에러 핸들링 필요
2. 운영 복잡성 증가
	소규모 팀에서는 서비스 분리로 인한 관리의 복잡도와 운영 부담이 증가

### 데이터 저장소 요구사항의 변화
이전에 많이 사용되던 RDBMS(관계형 데이터베이스)는 테이블의 구조를 정의하고 테이블간 관계를 잘 정리해 사용했다.

하지만 최근의 서비스에서는 정해진 형태가 없고 크기와 구조를 예측할 수 없는 비정형 데이터가 증가하는 추세다.
이런 비정형 데이터는 다차원적이거나 깊은 계층구조를 가질 수 있어 RDBMS에서 관리하기가 어렵다.
```
비정형 데이터란?
 - 정해진 구조가 없거나 매우 유연한 구조의 데이터
   ex) json 형식, 파일 데이터, 로그 데이터 등
```

이런 추세가 NoSQL의 필요성을 증가시켰다.

또한 MSA의 장점인 기술 스택의 자유로 인해 NoSQL이 필요한 서비스에서는 NoSQL을 적용할 수 있고
다른 서비스에서는 RDB를 선택할 수 있다.


## NoSQL이란?
NoSQL이란 용어는 No SQL 또는 Not Only SQL을 의미한다.(쿼리를 사용하지 않는 저장소)

NoSQL에도 여러 타입이 있지만 관계가 정의돼 있지 않은 데이터를 저장한다는 공통적인 특징이 존재

### NoSQL의 특징
1. 실시간 응답
	빠른 응답 속도로 MSA의 단점을 커버할 수 있다.
	MSA는 개별 서비스가 빠르게 동작하지 않을 때 서비스 자체가 병목을 유발할 수 있기 때문에 빠른 응답이 중요하다.
2. 확장성
	서비스의 업그레이드로 인한 계획적인 확장뿐만 아니라 이벤트 등 예상치 못한 상황에서도 유연하게 확장 가능
3. 고가용성
	데이터 저장소의 장애는 서비스의 장애로 이어진다.
	따라서 신속하게 복구돼 항상 사용할 수 있는 상태를 유지해야한다.
4. 클라우드 네이티브
	클라우드 제공 업체에서 제공하는 DBaas(BataBase-as-a-service)를 활용하면 쉽게 이용가능
5. 단순성
	MSA 처럼 서비스가 세분화될수록 관리 포인트는 늘어나기 때문에 간단하게 활용할 수 있는 것이 좋다.
6. 유연성
	비정형 데이터가 많아졌기 때문에 다양한 방식으로 데이터를 저장할 수 있는 저장소가 필요하다. 


## NoSQL 데이터 저장소 유형

### 그래프 유형
![[KakaoTalk_Photo_2025-09-07-14-47-44 001.jpeg|875]]
엔티티 간의 관계를 효율적으로 저장하도록 설계

**그래프 유형 구성**
노드, 엣지, 속성으로 데이터를 나타냄

노드 : 엔티티
엣지 : 데이터 사이의 관계

**그래프 유형 특징**
엣지는 항상 시작 노드 ,끝 노드, 유형과 방향을 가지며 상하위 관계, 동작, 소유자 등의 정보를 저장

추천 서비스에서 유용하게 사용된다.
ex) SNS 친구관계를 이용한 친구추천, 쇼핑몰 상품추천 등

### 칼럼 유형
![[KakaoTalk_Photo_2025-09-07-14-47-45 002.jpeg]]
행이 아닌 열을 기준으로 저장

**칼럼 유형의 특징**
관계형 데이터베이스와 비교했을 때보다 유연한 스키마 저장 가능
ex)
```
user_profiles 테이블 (Cassandra):
+--------+---------------+----------------+
| id     | column_name   | column_value   |
+--------+---------------+----------------+
| user1  | name          | 김철수         |
| user1  | email         | kim@email.com  |
| user1  | age           | 30             |
| user1  | city          | 서울           |
| user1  | hobby         | 축구           | ← 동적 추가 가능!
| user1  | favorite_food | 김치찌개       | ← 또 다른 동적 추가!
+--------+---------------+----------------+
| user2  | name          | 박영희         |
| user2  | email         | park@email.com |
| user2  | age           | 25             |
| user2  | job           | 개발자         | ← user1에는 없는 컬럼!
| user2  | skill         | Java           | ← user1에는 없는 컬럼!
+--------+---------------+----------------+
```
구조가 정해지지 않아도 동적으로 데이터를 추가할 수 있음
(만약 RDB 였다면 위의 예시에서는 job, skill이라는 새 컬럼을 추가하고 모든 행이 NULL로 들어 갔을 것이다.)

대량의 데이터에 대한 집계 쿼리를 빠르게 처리할 수 있어 분석, 보고, 빅데이터 처리등에 사용됨

Cassandra, Hbase 등이 컬럼 유형 NoSQL

**문서 유형**
![[KakaoTalk_Photo_2025-09-07-14-47-45 003.jpeg]]
json 형태로 저장돼 개발자들이 편하게 사용할 수 있는 구조

**문서 유형의 특징**
스키마가 따로 정해져 있지 않아 애플리케이션에 맞게 데이터를 그대로 저장하여 유연성이 크다.
모든 값은 항상 키와 연결되는 계층적 트리와 같은 구조를 갖는다.

MongoDB, CouchDB 등이 문서 유형 NoSQL

**키-값 유형**
![[KakaoTalk_Photo_2025-09-07-14-47-45 004.jpeg]]
가장 단순하고 빠른 유형

키는 RDB의 PK 같은 역할을 한다.
모든 값은 키에 연결되어 있으며 키 자체도 유의미한 데이터이다.

**키-값 유형의 특징**
데이터의 저장이 간단해서 다른 유형보다 수평적 확장이 쉽다.
빠른 응답속도로 실시간 서비스에서 많이 사용된다.

Redis, Memcached 등이 키-값 유형 NoSQL


## 레디스 란?
고성능 키-값 유형의 인메모리 NoSQL 데이터베이스

### 레디스의 특징

**실시간 응답(빠른 성능)**
온디스크 데이터베이스와 달리 모든 데이터가 RAM에 저장되기 때문에 데이터 처리 성능이 굉장히 빠름

```
On-Disk database의 데이터 처리
디스크의 데이터를 페이지 단위로 메모리에 올림 > 메모리에서 데이터 찾기
> 없으면 다른 페이지를 메모리에 올림 > 메모리에서 데이터 찾기 ........ 반복

In-Memory database의 데이터 처리(Redis)
메모리에 저장된 데이터를 바로 찾음
```

**단순성**
키에 매핑되는 값에 문자열, Hash, set 등 다양한 데이터 구조를 지원해서 추가적인 데이터 가공없이 애플리케이션에서 쉽게 사용

싱글 스레드로 동작해서 동기화, 잠금 메커니즘 없이도 안정적이고 빠르게 활용 가능 

**고가용성**
복제를 통해 데이터를 여러 서버에 분산
센티널을 통해 장애 상황을 탐지해 자동으로 페일오버(fail-over) 시켜주는 기능

**확장성**
클러스터 모드를 사용한다면 손쉬운 수평적 확장이 가능
![[KakaoTalk_Photo_2025-09-07-16-12-57.jpeg]]
데이터는 레디스 클러스터 내에서 자동으로 샤딩된 후 저장되며 여러 개의 복제본이 생성될 수 있다.
```
샤딩이란?
하나의 큰 테이블을 여러 개의 작은 테이블로 나누어 분산 저장하는 것
ex)
1억 개의 레코드가 있는 거대한 테이블을
2,500만개 씩 4개의 테이블로 나누어 분산 저장
```

데이터의 분리는 데이터베이스 레이어에서 처리되며 애플리케이션에서는 어떤 샤드에 데이터가 있는지 신경쓰지 않아도 된다.

**클라우드 네이티브-멀티 클라우드**
클라우드 네이티브 : 클라우드 환경에 특화된 애플리케이션의 개발 및 운영 방식
빠른 배포, 높은 확장성, 높은 복원력을 가진 애플리케이션을 추구하여 MSA와 잘 어울린다.

레디스는 빠른 데이터 액세스 및 처리를 지원하는 구조로 MSA와의 연계에서 큰 장점을 가진다.


멀티 클라우드 : 여러 클라우드 제공업체의 서비스를 동시에 혹은 혼합해 활용하는 전략
단일 클라우드 환경의 장애나 제한된 자원에 대한 의존성을 줄이고 클라우드 회사 별 강점 활용 가능

레디스는 여러 환경에 걸쳐 일관된 성능과 기능을 제공

## 마이크로 서비스 아키텍처와 레디스

### 데이터 저장소로서의 레디스
레디스는 간편한 설치, 적은 리소스 사용량, 다양한 자료 구조 제공 등의 장점을 보유하고 있다.
이는 MSA의 요구 사항에 맞는 데이터 저장소로 활용하기 적합하다.

데이터를 메모리에서 관리하기 떄문에 데이터 영속성의 문제가 있으나
이는 AOF(Append Only File)와 RDB(Redis DataBase) 형식으로 해결할 수 있다.

### 메시지 브로커로서의 레디스
MSA는 각 서비스가 완전리 분리돼 있는 구조이기 때문에 서비스 간 지속적인 통신이 필요하다.
메시징 큐 또는 스트림과 같은 메시지 브로커를 이용해서 서비스들 간에 비동기적으로 데이터를 전달할 통신 채널을 구현해야한다.

레디스는 데이터 저장소 말고도 메시지 브로커의 역할에 유용하게 사용할 수 있다.

레디스의 pub/sub 기능은 간단한 메시징 기능으로 활용할 수 있다.
```
pub/sub 기능이란?

발행자(publisher)가 메시지를 발행하면 구독자(subscriber)가 실시간으로 받는 메시징 패턴의 기능
```
pub/sub에서는 전달된 뒤 삭제되는 일회성으로 모든 메시징 상황에 적합하진 않지만 간단한 알림 서비스에는 유용하다.

레디스의 list 자료구조는 메시징 큐로 사용하기에 알맞다.
애플리케이션은 list에 데이터가 있는지 매번 확인할 필요 없이 대기하다가 list에 새로운 데이터가 들어오면 읽어 갈 수 있는 블로킹 기능을 사용할 수 있다.

레디스의 stream 자료 구조를 이용하면 레디스를 스트림 플랫폼으로 사용할 수 있다.
stream은 카프카에서 영감을 받아 만들어진 자료 구조로 데이터가 계속 추가되는 방식으로 저장된다.
```
Redis Stream 이란?
메시지를 시간순으로 저장하고 여러 소비자가 처리할 수 있는 지속성이 있는 메시지 큐이다.
```


