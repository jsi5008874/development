  

인증을 풀기 위해 가능한 모든 값을 대입하는 공격

  

ex) 아이디, 비밀번호 해킹을 위해 가능한 모든 값을 세팅하여 로그인 요청을 보냄

무작위의 아이디, 비밀번호로 계속 요청을 보내서 로그인이 되는 아이디, 비밀번호를 찾는 것

  

이렇게 하면 경우의 수가 너무 많아서 처음부터 유효한 경우의 수만 세팅하여 대입 공격을 한다.

예를 들어 id : admin, pw : qwe123!@# 이런식으로 사람들이 자주 사용하는 아이디 비밀번호를

이용하여 대입 공격을 하는 것

  

### X-Forwarded-For(XFF) 헤더 조작

http 헤더 중 XFF라는 속성이 있다.

해당 속성은 클라이언트의 진짜 IP를 전해주는 속성이다.

**이는 서버가 로드밸런서같은 프록시 서버를 거쳐갈 경우 백엔드 서버에서 클라이언트의 IP를 알 수 있게 해주기 위함이다.**

**(프록시 서버를 거쳐갈 경우 요청 IP는 프록시 서버의 IP로 넘어가기 때문에 진짜 클라이언트의 IP를 백엔드 서버에서 알 수 있도록 해주는 헤더)**

  

이를 조작하는 이유는 무차별 대입 공격은 엄청난 수의 요청을 보내는데 보통 서버에서 동일한 IP가

잘못된 로그인 요청을 여러번 실행하면 해당 IP를 차단하는 경우가 많기 때문에 IP를 우회하기 위해

XFF 헤더를 조작해서 요청을 보낸다.

### Response의 length 차이를 활용한 무차별 대입 공격

무차별 대입 공격을 하면 수 많은 response의 데이터가 쌓인다.

여기서 reponse의 data length가 다른 요청을 찾는 것이다.

무차별 대입 공격의 대부분은 로그인 실패했다는 response를 받겠지만

아이디가 존재하고 비밀번호만 틀렸다던지, 로그인이 된 요청은 response가

다르게 올 것이다.

  

그러면 response의 길이가 다를것이므로 이 점을 이용해서 아이디, 비밀번호를 탈취한다.

  

### Response 응답 시간을 활용한 무차별 대입 공격

공격 시 수 많은 response 중 응답 시간을 비교하는 방법이다.

서버에서는 아이디가 존재하면 비밀번호와 매칭해보는 로직이 존재할 것이다.

그렇다면 response를 보내주는데 더 많은 시간이 걸리기 때문에 이런 점을 노려서

response 응답 시간을 비교하여 오래 걸린 response가 유효한 아이디일 확률이 높다.

  

이런식으로 유효한 아이디, 비밀번호를 탈취하여 해킹을 한다.

  

  

### 무차별 대입 공격 대응법

무차별 대입 공격 보호는 프로세스를 자동화하고 공격자가 로그인 시도하는 속도를 늦추고 최대한

까다롭게 만드는 것이다.

  

1. 사용자가 로그인 시도 실패를 많이 할 경우 해당 사용자의 계정을 잠금
2. 사용자가 너무 빠른 속도로 많은 로그인을 시도할 경우 해당 사용자의 IP 차단

  

해당 방법들이 무적은 아니며 로직을 잘못 구현하면 아무 소용이 없다.

예를 들면 로그인 실패 횟수가 많으면 IP를 차단하는 로직인데 IP 소유자가 성공적으로 로그인을 한다면 실패 횟수 카운터가 재설정되는 방식으로 구현되어있다.

이 때 공격자가 횟수 제한 도달 전 자신의 아이디로 로그인을 하면 해당 IP에 대한 횟수는 초기화되어

다시 로그인 시도를 할 수 있게된다.

  

계정 잠금도 유효하지 않는 경우가 많다.

특히 자격 증명 스터핑(credential stuffing attacks)으로 부터의 위협을 막을 순 없다.

자격 증명 스터핑은 대부분의 사람이 여러 사이트에서 동일한 아이디와 비밀번호를 사용한다는 점을 악용하는 것이다.

따라서 비슷한 아이디 비밀번호를 통해 여러 웹사이트의 계정을 손상시킬 위협이 있다.

  

그래서 다중 인증 체계를 채택하는 서비스들도 많다.

예를 들면 생체 인식, OTP, 보안 코드등 2차 보안체계를 구성해서 보안성을 강화한다.