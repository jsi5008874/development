  

`**save()**` 메서드는 삽입 객체의 **ID 필드**를 통해 Insert 또는 Update 여부를 자동으로 결정합니다.

JPA에서 `**save()**` 메서드는 아래와 같은 방식으로 Insert 또는 Update 작업을 처리합니다:

1. **엔티티의 ID 필드가 이미 설정된 경우**:
    - 삽입 객체에 **ID 값이 존재**하면, JPA는 해당 ID를 기준으로 기존 레코드를 찾습니다.
    - **해당 ID의 레코드가 이미 존재**한다면, 해당 레코드를 갱신(즉, Update)하게 됩니다.
2. **엔티티의 ID 필드가 없는 경우**:
    - ID가 null이거나 설정되지 않은 경우에는 새로 Insert 작업을 수행하여 새로운 레코드를 추가합니다.

  

### 예시

어떤 DTO를 DB에 삽입해야한다고 가정

save()로 해당 DTO를 insert를 한다면 해당 DTO의 값을 가지고 JPA가 DB에 삽입을 한다.

삽입을 하려면 DTO에는 ID값(primary key의 값)이 이미 들어가 있는 상태이고

해당 DTO 자체에 ID 값이 존재하고 있을 것이다.

ex) id, name, age를 가진 UserDto 객체가 있다면

해당 DTO를 삽입하려면 heap에 객체가 인스턴스화 되고

id=1, name=’김주성’, age = 31 이런식으로 DTO에 값들이 들어가 있어야한다.

해당 DTO를 삽입하면 UserDto에는 id=1이라는 값이 이미 인스턴스화되서 가지고 있고

age=32로 바꾼 후 다시 save()를 하면 이미 UserDto에는 id=1이라는 값이 들어있기 때문에

가지고 있던 id 값을 기준으로 DB에서 조회하고 DB에 id=1이라는 값이 있었다면 update를 실행

  

id를 설정하지 않고 DB로 넘기는 경우에도 DB가 자동으로 생성하고 그 값을 JPA가 엔티티의 id 필드에 설정한다.

  

**즉 엔티티의 id 필드 값을 기준으로 insert와 update를 결정한다.**

  

같은 객체를 save()를 한다면 그 때는 insert가 아닌 update를 한다는 뜻